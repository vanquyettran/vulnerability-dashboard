import './TextInput.less';
import React, {useState, forwardRef, Ref, useRef} from 'react';

export interface TextInputProps {
    value: string,
    setValue: (value: string) => void,
    placeholder?: string,
    onFocus?: React.EventHandler<React.FocusEvent<HTMLInputElement>>,
    onBlur?: React.EventHandler<React.FocusEvent<HTMLInputElement>>,
}

export default forwardRef(function TextInput(
    {
        value,
        setValue,
        placeholder,
        onFocus = () => undefined,
        onBlur = () => undefined,
    }: TextInputProps,
    ref: Ref<HTMLDivElement>
) {
    const [focused, setFocused] = useState(false);

    return (
        <div
            className={[
                'TextInput',
                value === '' && 'empty',
                focused && 'focused',
            ]}
            ref={ref}
        >
            <input
                value={value}
                placeholder={placeholder}
                onKeyDown={(ev) => {
                    if (ev.key === 'Enter') {
                        const target = ev.target as HTMLInputElement;
                        target.blur();
                    }
                }}
                onChange={(ev) => {
                    setValue(ev.target.value);
                }}
                onFocus={(ev) => {
                    setFocused(true);
                    onFocus(ev);
                }}
                onBlur={(ev) => {
                    setFocused(false);
                    onBlur(ev);
                }}
            />
        </div>
    );
})
