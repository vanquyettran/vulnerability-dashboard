import './App.less';
import React, {Suspense, lazy} from 'react';
import {Switch, Route, BrowserRouter} from 'react-router-dom';
import routes from 'main/routing/routes';
import Layout from 'main/layout/Layout';
import NotFoundError from 'main/errors/not-found/NotFoundError';
import {RecoilRoot} from 'recoil';
import ContextsWrapper from 'main/contexts/ContextsWrapper';
import __ from './i18n';

const DashboardApp = lazy(() => import('./apps/dashboard/DashboardApp'));
const KanbanApp = lazy(() => import('./apps/kanban/KanbanApp'));

export default function App() {
    return (
        <React.StrictMode>
            <ContextsWrapper>
                <RecoilRoot>
                    <BrowserRouter>
                        <Layout>
                            <Suspense fallback={__('Loading...')}>
                                <Switch>
                                    <Route path={routes.dashboard.path} component={DashboardApp} exact/>
                                    <Route path={routes.kanban.path} component={KanbanApp} exact/>
                                    <Route component={NotFoundError}/>
                                </Switch>
                            </Suspense>
                        </Layout>
                    </BrowserRouter>
                </RecoilRoot>
            </ContextsWrapper>
        </React.StrictMode>
    );
}
