import React from 'react';
import {render, waitFor} from '@testing-library/react';
import DashboardApp from './DashboardApp';
import __ from 'main/i18n';
import AppProvider from 'main/AppProvider';
import Request from 'libs/http-request/Request';

describe('<DashboardApp/>', () => {
    const myRender = () => {
        const screen = render(
            <AppProvider>
                <DashboardApp/>
            </AppProvider>
        );

        return {screen};
    };

    it('renders title', () => {
        const {screen} = myRender();
        const title = screen.getByText(__('Your repos'));
        expect(title).toBeInTheDocument();
    });

    it('renders repos', async () => {
        Request.setTestMockQueue([
            {id: "a", name: "Saturn"},
            {id: "b", name: "Mercury"},
            {id: "c", name: "Earth"},
        ]);

        const {screen} = myRender();

        await waitFor(() => {
            expect(screen.getByText('Saturn')).toBeInTheDocument();
            expect(screen.getByText('Mercury')).toBeInTheDocument();
            expect(screen.getByText('Earth')).toBeInTheDocument();
        });
    });
});
