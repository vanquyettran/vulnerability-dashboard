import './CardForm.less';
import React from 'react';
import TextInput from 'uikit/components/text-input/TextInput';
import __ from 'main/i18n';
import {AjaxAction} from 'main/store/interfaces';
import Card from 'main/models/interfaces/Card';
import Parcel from 'libs/http-request/Parcel';

export default function CardForm(
    {values, setValues, action, parcel, onSuccess}: {
        values: Card,
        setValues: React.Dispatch<React.SetStateAction<Card>>,
        action: AjaxAction<Card>,
        parcel: Parcel<Card>,
        onSuccess?: (card: Card) => void,
    }
) {
    const {inProgress, error} = action.state;

    return (
        <form
            className="CardForm"
            onSubmit={(ev) => {
                ev.preventDefault();
                action.run(parcel).then(onSuccess);
            }}
        >
            <TextInput
                value={values.text}
                setValue={text => {
                    setValues({...values, text});
                }}
            />
            {
                error !== null &&
                <div className="error">
                    {error.message}
                </div>
            }
            <button
                type="submit"
                disabled={inProgress || values.text.trim().length === 0}
            >
                {inProgress ? __('Saving...') : __('Save')}
            </button>
        </form>
    );
}
