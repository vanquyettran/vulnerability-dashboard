import IEntity from 'main/interfaces/IEntity';
import IRepo from 'main/interfaces/IRepo';
import IList from 'main/interfaces/IList';
import ICard from 'main/interfaces/ICard';
import Parcel from 'libs/http-request/Parcel';
import ResponseError from 'libs/http-request/ResponseError';

export interface IEntityData<T extends IEntity> {
    byId: {[key: string]: T},
    allIds: string[]
}

export interface IRepoData extends IEntityData<IRepo> {}

export interface IListData extends IEntityData<IList> {}

export interface ICardData extends IEntityData<ICard> {}

export type AjaxState = {
    inProgress: boolean,
    error: ResponseError | null,
}

export interface IEntityStore<T extends IEntity> {
    data: IEntityData<T>,
    add: (...entities: T[]) => void,
    remove: (entityId: T['id']) => void,
    update: (entity: T) => void,
    ajaxBulkAdd: {
        run: (
            parcel: Parcel<T[]>,
            onSuccess?: (entities: T[]) => void,
            onError?: (error: ResponseError) => void
        ) => typeof parcel,
        state: AjaxState
    },
    ajaxAdd: {
        run: (
            parcel: Parcel<T>,
            onSuccess?: (entity: T) => void,
            onError?: (error: ResponseError) => void
        ) => typeof parcel,
        state: AjaxState
    },
    ajaxRemove: {
        run: (
            parcel: Parcel<T>,
            onSuccess?: (entity: T) => void,
            onError?: (error: ResponseError) => void
        ) => typeof parcel,
        state: AjaxState
    },
    ajaxUpdate: {
        run: (
            parcel: Parcel<T>,
            onSuccess?: (entity: T) => void,
            onError?: (error: ResponseError) => void
        ) => typeof parcel,
        state: AjaxState
    }
}

export interface IRepoStore extends IEntityStore<IRepo> {}

export interface IListStore extends IEntityStore<IList> {}

export interface ICardStore extends IEntityStore<ICard> {}
